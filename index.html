animate();

        // ============================================
        //  SCAN & API LOGIC (G-V)
        // ============================================

        // 1. 點擊掃描儀 -> 觸發「隱藏的檔案輸入框」
        scanner.addEventListener('click', () => {
            scanner.classList.toggle('active'); // 視覺反饋
            cursor.style.transform = 'translate(-50%, -50%) scale(0.8)';
            setTimeout(() => cursor.style.transform = 'translate(-50%, -50%) scale(1)', 150);
            
            // 打開檔案選擇器
            document.getElementById("uploadBtn").click();
        });

        // 2. 監聽上傳動作
        const uploadBtn = document.getElementById("uploadBtn");
        if (uploadBtn) {
            uploadBtn.addEventListener("change", async (e) => {
                const files = e.target.files;
                if (files && files.length > 0) {
                    await runScan(files);
                }
            });
        }

        // 3. 呼叫 Vercel API (本地路徑)
        async function runScan(files) {
            console.log("System: Analyzing assets...");
            const formData = new FormData();
            
            // 把所有選到的檔案放進表單
            for (let i = 0; i < files.length; i++) {
                formData.append(`image${i+1}`, files[i]);
            }

            document.body.classList.add("scanning");

            try {
                // 因為我們在 G (GitHub) -> V (Vercel)，
                // API 就在我們隔壁，所以用相對路徑 /api/scan 即可
                const res = await fetch("/api/scan", {
                    method: "POST",
                    body: formData
                });

                if (!res.ok) throw new Error("API Connection Failed");

                const data = await res.json();
                console.log("SCAN RESULT:", data);
                
                // TODO: 收到資料後，看你要跳轉頁面還是顯示卡片
                alert("Scan Complete! Data received.");

            } catch (err) {
                console.error("Error:", err);
                alert("System Error: Check API connection.");
            } finally {
                document.body.classList.remove("scanning");
            }
        }
    </script>
</body>
</html>



